validationTypes=new Object();validationTypes.string=is_valid_string;validationTypes.integer=is_valid_integer;validationTypes["float"]=is_valid_float;validationTypes.dollars=is_valid_dollars;validationTypes.date=is_valid_date;validationTypes.time=is_valid_time;validationTypes.email=is_valid_email;validationTypes.zipcode=is_valid_zipcode;validationTypes.usphone=is_valid_us_phone;validationTypes.ccnum=is_valid_cc_number;validationTypes.ccexp=is_valid_cc_expiration;function validate_form(c){if(!c||!c.elements||!window.formRules){return true}var j=new Array();var h=new Array();var k=null;var r=new Array();for(var f=0;f<window.formRules.length;++f){var q=window.formRules[f].fieldName;var o=c.elements[q];if(!o){continue}var p=get_field_value(o);if(p==""){if(window.formRules[f].required){j[j.length]=window.formRules[f].description;if(!k){k=q}}continue}var n=window.formRules[f].validationType;if(n.toLowerCase()=="ccexp_month"){r[0]=p;continue}else{if(n.toLowerCase()=="ccexp_year"){r[1]=p;continue}}var m=new Array();if(n.length>=7&&n.substr(0,7)=="string|"){var e=n.substr(7);var l=e.indexOf(",");if(l>0&&l!=e.length-1){m[0]=e.substr(0,l);m[1]=e.substr(l+1)}n="string"}var g=validationTypes[n];if(!g){continue}var a;if(n!="string"){a=g(p)}else{a=g(p,m[0],m[1])}if(a===false){h[h.length]=window.formRules[f].description;if(!k){k=q}}else{set_field_value(o,a)}}var d="";if(j.length>0){if(j.length==1){d="A required field was not filled in.\n\n"}else{d="Some required fields were not filled in.\n\n"}d+="Please enter "+list_fields(j)+" to continue.\n"}else{if(h.length>0){if(h.length==1){d="A field contains invalid input.\n\n"}else{d="Some fields contain invalid input.\n\n"}d+="Please re-enter "+list_fields(h)+" to continue.\n"}else{if(r.length==2){var g=validationTypes.ccexp;var b=r[0]+"/"+r[1];if(g&&g(b)==false){d="The expiration date you gave for your credit card does not appear to be valid.\n\n";d+="Please re-enter a valid future date to continue.\n"}}}}if(d.length){if(k){if(c.elements[k].select){c.elements[k].select()}if(c.elements[k].focus){c.elements[k].focus()}}alert(d);return false}if(window.moreValidation){var d=window.moreValidation();if(d&&d.length){alert(d);return false}}return true}function Rule(d,b,c,a){this.fieldName=d;this.description=b;this.required=c;this.validationType=a}function get_field_value(b){if(b.type=="text"||b.type=="textarea"||b.type=="password"){return b.value}if(b.type=="select-one"||b.type=="select-multiple"){if(b.selectedIndex==-1){return""}else{return b.options[b.selectedIndex].value}}if(b[0]&&b[0].type=="radio"){for(var a=0;a<b.length;++a){if(b[a].checked){return b[a].value}}return""}return""}function set_field_value(b,c){if(b.type=="text"||b.type=="textarea"||b.type=="password"){b.value=c;return true}if(b.type=="select-one"||b.type=="select-multiple"){for(var a=0;a<b.options.length;++a){if(b.options[a].value!=c){continue}b.selectedIndex=a;return true}return false}if(b[0]&&b[0].type=="radio"){for(var a=0;a<b.length;++a){if(b[a].value!=c){continue}b[a].checked=true;return true}return false}return false}function list_fields(d){var b="";var a=d.length-1;for(var c=0;c<=a;++c){if(c){if(a>0&&c==a){b+=" and "}else{b+=", "}}b+=d[c]}return b}function is_valid_string(e,c,b){if(e==null){return false}else{if(e.trim()==""){return false}}var d=parseInt(c,10);if(!isNaN(d)&&e.length<d){return false}var a=parseInt(b,10);if(!isNaN(a)&&e.length>a){return false}return e}function is_valid_integer(a){if(a==null){return false}a=a.replace(/,/ig,"");if(/^\d+$/.test(a)){return a}return false}function is_valid_float(a){if(a==null){return false}a=a.replace(/,/ig,"");if(is_valid_integer(a)){return a}if(/^\d+\.\d+$/.test(a)){return a}return false}function is_valid_dollars(a){if(a==null){return false}a=a.replace(/,/ig,"");a=a.replace(/\$/ig,"");if(is_valid_integer(a)){return a}if(/^\d+\.\d{1,2}$/.test(a)){return a}return false}function is_valid_date(a){if(a==null){return false}if(/^\d{4,4}-\d{1,2}-\d{1,2}$/.test(a)){return a}if(/^\d\d-\d{1,2}-\d{1,2}$/.test(a)){return a}if(/^\d{1,2}\/\d{1,2}\/\d{4,4}$/.test(a)){return a}if(/^\d{1,2}\/\d{1,2}\/\d{2,2}$/.test(a)){return a}if(/^\d{1,2}\/\d{1,2}$/.test(a)){return a}return false}function is_valid_time(g){if(g==null){return false}var f=(g.toLowerCase().indexOf("am")!=-1||g.toLowerCase().indexOf("a.m.")!=-1);var b=(g.toLowerCase().indexOf("pm")!=-1||g.toLowerCase().indexOf("p.m.")!=-1);g=g.replace(/pm/ig,"").replace(/am/ig,"");g=g.replace(/p\.m\./ig,"").replace(/a\.m\./ig,"");g=g.replace(/ /g,"");var e=g;var a=0;var c=0;var i=e.indexOf(":");if(i>0&&i<e.length-1){a=e.substr(i+1);e=e.substr(0,i);i=a.indexOf(":");if(i>0&&i<a.length-1){c=a.substr(i+1);a=a.substr(0,i)}}e=parseInt(e,10);a=parseInt(a,10);c=parseInt(c,10);if((f||b)&&(e>12||e==0)){return false}if(b&&(e<12)){e+=12}if(e<0||e>23||a<0||a>59||c<0||c>59){return false}var h=new Date(0,0,0,e,a,c);if(isNaN(h.getTime())){return false}return g}function is_valid_email(b){if(b==null){return false}if(/^\w+([\./+/-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,6})+$/.test(b)||/^[\w ]+<\w+([\./+/-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,6})+>$/.test(b)){var a=RegExp.lastParen.toLowerCase();if(a.length<=5){return b}if(a==".museum"||a==".travel"){return b}else{return false}}return false}function is_valid_zipcode(a){if(a==null){return false}if(a.length==5){return is_valid_integer(a)}else{if(a.length==10){var b=a.indexOf("-");if(b!=5){return false}if(!is_valid_integer(a.substring(0,b))){return false}if(!is_valid_integer(a.substring(b+1))){return false}return a}}return false}function is_valid_us_phone(e){if(e==null){return false}var a="0123456789 -()/.";var d="";for(var b=0;b<e.length;++b){var c=e.charAt(b);if(a.indexOf(c)==-1){return false}if(!isNaN(parseInt(c,10))){d+=""+c}}if(d.length!=10){return false}return e}function is_valid_cc_number(f){if(f==null){return false}if(!window.cardTypes){return true}var e=f.replace(/[^0-9]/ig,"");if(!_check_mod_10(e)){e=f.replace(/o/ig,"0").replace(/l/ig,"1").replace(/[^0-9]/ig,"");if(!_check_mod_10(e)){return false}}for(var a in window.cardTypes){var c=new RegExp(window.cardTypes[a]);if(!c.test(e)){continue}var d=true;if(window.cardRules){d=false;for(var b=0;b<window.cardRules.length;++b){if(a!=window.cardRules[b]){continue}d=true;break}}if(d){return e}}return false}function _check_mod_10(d){if(!d.length){return false}var a="";for(var b=d.length;b>0;--b){a+=d.charAt(b-1)}var c=0;for(var b=0;b<a.length;++b){var e=parseInt(a.charAt(b),10);if(b%2){e*=2}if(e>9){e-=9}c+=e}if(c%10){return false}return true}function is_valid_cc_expiration(j){var k="/- .";var e,g,b=null;for(var c=0;c<k.length;++c){var a=k.charAt(c);if(k.indexOf(a)==-1){continue}b=j.split(a);if(b.length!=2){continue}e=b[0];g=b[1];break}if(!e||!g){b=j.replace(/^\d/ig,"");if(b.length!=4&&b.length!=6){return false}e=b.substr(0,2);g=b.substr(2)}e=parseInt(e,10);g=parseInt(g,10);if(isNaN(e)||isNaN(g)){return false}if(e<1||12<e){return false}var h=new Date();var f=h.getMonth()+1;var d=h.getFullYear();if(g<100){g+=2000}if(g<d){return false}if(g==d&&e<f){return false}if(e<10){e="0"+e}return e+"/"+g};