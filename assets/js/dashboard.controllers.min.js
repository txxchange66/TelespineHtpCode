/*
Last Updated: February 6, 2014 at 8:08:10 PM
Creative Slave - demo.creativeslave.com
*/
var Dashboard={properties:{configuration:{baseImageURL:"/admin/assets/img/",baseComponentURL:"components/"}},history:[],init:function(a){Dashboard.console.log("Loading Dashboard...");$("#OverlayBG").css("visibility","visible");this.properties=a;if(Dashboard.isMobile()){Dashboard.properties.configuration.startDate=new Date(Date.parse(Dashboard.properties.configuration.startDate))}else{Dashboard.properties.configuration.startDate=new Date(Dashboard.properties.configuration.startDate)}$("#loading").css("visibility","visible");Dashboard.loadProperties("/admin/components/properties.html");Dashboard.load()},loadProperties:function(a){Dashboard.console.log("Dashboard: Testing Load Properties...")},load:function(){var a=this.properties.components.length;Dashboard.console.log("Loading Dashboard Components ("+a+")");var d=this.properties;for(c=0;c<a;c++){Dashboard.console.log("Reading Component: "+d.components[c].id);try{if(d.components[c].load&&d.components[c].url!="void"){if(Dashboard.properties.configuration.loggingVerbose){Dashboard.console.log(d.components[c])}Dashboard.console.log(" > Loading Component: ("+d.components[c].id+") from "+d.baseComponentURL+d.components[c].url,2);$.ajax({type:"GET",url:d.configuration.baseComponentURL+d.components[c].url,async:false,contentType:"application/text",success:function(e){$("#col_"+d.components[c].column).append(e+'<div class="clearfix"></div>');try{d.components[c].callback(d.components[c])}catch(g){Dashboard.console.log("Error executing function ("+d.components[c].callback+"): "+g)}},error:function(g,e,h){Dashboard.console.log(" > > Ajax Error when invoking "+d.components[c].id+": "+g+"; "+e+"; "+h)}})}else{Dashboard.console.log(" > Skip load component: "+d.components[c].id);if(d.components[c].load&&d.components[c].url=="void"){d.components[c].callback()}}}catch(b){Dashboard.console.log(" > > Ajax Outer Error when invoking "+d.components[c].id+": "+b.message)}}setTimeout(function(){$("#loading div").html("");$("#loading").animate({width:"10%",height:"10%","margin-left":"-5%",opacity:0},400);setTimeout(function(){$("#OverlayBG").animate({opacity:0},400);setTimeout(function(){$("#loading").css("visibility","hidden");$("#OverlayBG").css("visibility","hidden")},400)},400)},400);try{}catch(f){}},getComponent:function(e){var d=this;try{var a=d.properties.components.length;for(c=0;c<a;c++){if(Dashboard.properties.configuration.loggingVerbose){Dashboard.console.log(" > > getComponent: "+d.properties.components[c].id,4)}if(d.properties.components[c].id==e){return d.properties.components[c]}}}catch(b){d.console.log(" > getComponent(): Error "+b);return null}},showHelp:function(a){Dashboard.console.log("function :: showHelp("+a+")");var b=[];b.painMeter="Current Pain Level Overview";b.functionalScore="Functional Score Overview";b.goalsAndStatistics="Goals and Statistics Overview";b.healthyHabits="Healthy Back Habits Overview";b.timelie="Timeline Overview";b.today="Today's Activities Overview";b.other="Overview";$("div.dialog-help").hide();$("#overviewTitle").html(b[a]);$("#dialog-"+a).show()},callService:function(a){Dashboard.console.log("service :: callService for "+a);var b=this;if(b.getComponent(a)){$.ajax({type:"GET",url:b.properties.configuration.baseComponentURL+b.getComponent(a).service.url,async:false,contentType:"application/text",success:function(d){b.getComponent(a).service.callback(d)},error:function(d){b.console.log(" > Ajax Error when invoking "+a+": "+d.message)}})}},callServiceModule:function(b){Dashboard.console.log("service :: callService for "+b.componentId);var a=this;if(a.getComponent(b.componentId)){$.ajax({type:"GET",url:b.url,async:false,data:b.data,contentType:"application/text",success:function(d){b.callback(d)},error:function(d){Dashboard.console.log(" > Ajax Error when invoking "+b.componentId+": "+d.message)}})}},displayComponent:function(b,a){b.load=a;try{if(a){$("#"+b.id+"_comp").show()}else{$("#"+b.id+"_comp").hide()}}catch(d){Dashboard.console.log(d)}},isMobile:function(){return(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))},console:{log:function(a,d){try{if(Dashboard.properties.configuration.logging==true){if(!d){if(console){console.log(a)}}else{if(d<=Dashboard.properties.configuration.loggingLevel){if(console){console.log(a)}}}}}catch(b){}}},daysBetween:function(g,f){var b=Math.abs(g.getTimezoneOffset()/60)-Math.abs(f.getTimezoneOffset()/60);f.addHours(b);var h=1000*60*60*24;var e=g.getTime();var d=f.getTime();var a=Math.abs(e-d);return Math.round(a/h)},preference:function(b,d){var e="TelespinePrefs";var a={components:["weeklyTimeline:0","goalsAndStatistics:0","painMeter:0","functionalScore:0","onlineCoaching:0","messages:0","today:0"],theme:"default"};if(!d){}else{if(d.toLowerCase()=="delete"){}else{}}},hasHistory:function(a){return(Dashboard.history[a])},setHistory:function(a,b){Dashboard.history[a]=b},getHistory:function(a){return Dashboard.history[a]}};function ServiceCall(a){this.componentId=a;this.url="";this.name="";this.data={};this.callBack=function(b){}}function DomRenderer(a){this.componentId=a;this.data={};this.apply=function(b){}}Dashboard.openFirstTimeUser=function(){Dashboard.console.log(" First Time User Message welcome screen.",2);if(Dashboard.properties.configuration.firstTimeUser){$("#FirstTimeUser").modal({backdrop:"static",keyboard:false})}};Dashboard.openFirstTimeResetPassword=function(){Dashboard.console.log(" First Time User Reset Password.",2);if(Dashboard.properties.configuration.resetPassword.load){$("#ResetPassword").modal({backdrop:"static",keyboard:false});inForm.init("changePassword-form","fieldError",function(){try{$.ajax({type:"GET",url:Dashboard.properties.configuration.baseComponentURL+Dashboard.properties.configuration.resetPassword.service.url,async:false,data:{password:$("#newPassword").val()},contentType:"application/json",success:function(b){Dashboard.console.log(" Response: "+b);$("#ResetPassword").modal("hide");Dashboard.openSurvey()},error:function(b){base.console.log(" > Ajax Error when invoking password update: "+b.message)}})}catch(a){Dashboard.console.log(" > Set Password Error: "+a)}return false})}};Dashboard.openSurvey=function(){Dashboard.console.log("\n****************\nOpen Survey",2);if(Dashboard.properties.configuration.survey.load){try{Dashboard.wizard.init("surveyWiz","surveyNextBtn","surveyPreviousBtn",function(){Dashboard.saveSurvey()})}catch(a){Dashboard.console.log(" Pain Level Error: "+a)}$("#surveyModal").modal({backdrop:"static",keyboard:false})}};Dashboard.saveSurvey=function(){Dashboard.console.log("Save Survey!");var b=Dashboard.getComponent("functionalScore");inForm.setFormId("survey-form");var a=inForm.getFormJSON();try{$.ajax({type:"GET",url:Dashboard.properties.configuration.baseComponentURL+Dashboard.properties.configuration.survey.service.url,async:false,data:a,contentType:"application/json",success:function(e){Dashboard.console.log(" Response: "+e);var f=e.split(",");Dashboard.console.log(" Survey resulting Functional Score: "+f);b.data.scores.push(f);Dashboard.setFunctionalScore(b)},error:function(e){base.console.log(" > Ajax Error when invoking survey: "+e.message)}})}catch(d){Dashboard.console.log(" > Save Survey Error: "+d)}$("#surveyModal").modal("hide");Dashboard.openTip("Tip1");Dashboard.console.log("Close Survey!\n****************")};Dashboard.openTip=function(a){Dashboard.console.log(" First Time User Message welcome screen.",2);if(Dashboard.properties.configuration.firstTimeUser){$("#"+a).modal({backdrop:"static",keyboard:false})}};Dashboard.timeline=function(){timeline=new WeeklyTimeline();Dashboard.timeline=timeline;Dashboard.timeline.init();setTimeout(function(){Dashboard.timeline.setActivities(Dashboard.getComponent("weeklyTimeline").data.activities)},2200)};Dashboard.addGoalsService=function(){var a=new ServiceCall("goalsAndStatistics");a.url="addGoal.html",a.callback=function(b){$("#GoalsList").prepend(b);var d=Dashboard.getComponent(a.componentId);d.data.goals[1]+=1;Dashboard.setStats(d)}};Dashboard.preference=function(b,d){var e="TelespinePrefs";var a={components:["weeklyTimeline:0","goalsAndStatistics:0","painMeter:0","functionalScore:0","onlineCoaching:0","messages:0","today:0"],theme:"default",configuration:{resetPassword:true,survey:{load:true},lastPainLevel:5,lastNewMessageDate:(new Date()).toString(),painLevelLastSet:(new Date()).toString(),theme:"default"}};if(!d){}else{if(d.toLowerCase()=="delete"){}else{}}};Dashboard.setStats=function(b){Dashboard.console.log(" Dashboard.setStats()");var d=Math.round(b.data.goals[0]/b.data.goals[1]*100);$("#MyLogins").html(b.data.logins);$("#GoalsInterface").fadeOut();$("#GoalsInterface").html('<i class="fa fa-thumbs-up"></i><span class="plus">+</span><span class="percent">%</span><input id="MyGoals" type="text" value="'+d+'" class="circleChart" />');$("#GoalsInterface").fadeIn();try{$(".circleChart").each(function(){var e=$(this).parent().css("color");$(this).knob({min:0,max:100,readOnly:true,width:120,height:120,fgColor:e,dynamicDraw:true,thickness:0.2,tickColorizeValues:true,skin:"tron"})})}catch(a){}try{if(Dashboard.history["goal-actions-set"]!="true"){Dashboard.console.log(" Setting click events to Goals");Dashboard.history["goal-actions-set"]="true";$(".goal-actions > a").click(function(f){Dashboard.console.log("Goal Click");Dashboard.updateGoal(f);return false})}}catch(a){Dashboard.console.log(a)}};Dashboard.setPainLevel=function(){Dashboard.console.log("function :: setPainLevel");var a=$(".pain-level-control").html();$.ajax({type:"GET",data:{painLevel:a},url:Dashboard.properties.configuration.baseComponentURL+Dashboard.properties.configuration.updatePainURL,async:false,contentType:"application/text",success:function(f){Dashboard.console.log(" > > Update Pain Response: "+f);$.gritter.add({title:"Pain Level Updated!",text:"Thank you! You have added a status update to your pain level. You set it to: "+a+" out of 10.",class_name:"my-sticky-class"});var h=Dashboard.getComponent("painMeter");h.data.pain+=","+a;$("#pailControl").hide();$(".pain-bubble").slideDown(300);var e="#eae874";if(parseInt(a)>6){e="#ff5454"}else{if(parseInt(a)<4){e="#78cd51"}}$(".pain-bubble").css("background-color",e);try{$("#painLevelGraph").html('<div id="pain-graph" class="chart red" style="width:100%">'+h.data.pain+"</div>");var d=$("#painLevelGraph").css("color");var g=$.range_map({"3":"green","4:6":"yellow","7:":"red"});$("#painLevelGraph > .chart").each(function(){$(this).sparkline("html",{width:"160%",height:70,lineColor:"red",colorMap:g,fillColor:false,spotColor:false,maxSpotColor:false,minSpotColor:false,spotRadius:4,lineWidth:4})});if(jQuery.browser.mozilla){$("#painLevelGraph").css("MozTransform","scale(0.5,0.5)");$("#painLevelGraph").css("height","40px;").css("margin","-20px 0px -20px -25%")}else{$("#painLevelGraph").css("zoom",0.6)}}catch(b){alert(b)}},error:function(f,e,g){Dashboard.console.log(" > > Ajax Error: "+f+"; "+e+"; "+g)}})};Dashboard.setPainLevelGraph=function(b){Dashboard.console.log("callback :: setPainLevelGraph()");try{var a=Dashboard.properties.configuration.lastPainLevel;if(!a){a=5}var d=$.range_map({"3":"green","4:6":"yellow","7:":"red"});$("#pain-graph").html(b.data.pain);$(".pain-level-control").html(a);$("#pain-level").slider({range:"min",value:a,min:0,max:10,slide:function(e,g){$(".pain-level-control").html(g.value)}})}catch(f){Dashboard.console.log(" Error setPainLevelGraph : "+f)}};Dashboard.setFunctionalScore=function(a){Dashboard.console.log("callback :: setFunctionalScore()");try{var d=a.data.scores.length-1;$("#currentFunctionalScore").html(a.data.scores[d][0]+"%");$("#currectPain").html((a.data.scores[d][1]/10)+"/10");for(var b=0;b<4;b++){this.setScore(a,b)}}catch(f){Dashboard.console.log(" Error setFunctionalScore : "+f)}};Dashboard.setScore=function(a,e){Dashboard.console.log(" > setScore(component, survey)");try{var d=a.data.scores[e];$(".f-score-"+(e+1)).animate({top:(100-d[0])+"%"},2500);$(".f-score-"+(e+1)).html(d[0]+"%");$(".p-score-"+(e+1)).animate({top:(100-d[1])+"%"},2500);$(".p-score-"+(e+1)).html(d[1]+"%");Dashboard.console.log(" > > Functional Score from Survey "+(e+1)+": "+(100-d[0]));Dashboard.console.log(" > > Pain Score from Survey "+(e+1)+": "+(100-d[1]))}catch(b){Dashboard.console.log("Expected Exception: "+b+" (This is expected because it is not yet set)");$(".f-bar-"+(e+1)).html("Pending")}};Dashboard.updateGoal=function(d){Dashboard.console.log("Dashboard.updateGoal > "+$(d.currentTarget).attr("id"));var b="";var f="";var i=Dashboard.getComponent("goalsAndStatistics");var h=d.currentTarget;try{Dashboard.console.log(" > TEST DOM: "+h)}catch(g){console.log(g)}try{if($(d.currentTarget).find("i").attr("class")=="fa fa-square-o"){$(d.currentTarget).find("i").removeClass("fa-square-o").addClass("fa-check-square-o");$(d.currentTarget).parent().parent().find("span").css({opacity:0.45});$(d.currentTarget).parent().parent().find(".desc").css("text-decoration","line-through");Dashboard.console.log(" > > Set Status Action to Complete");i.data.goals[0]+=1}else{$(d.currentTarget).find("i").removeClass("fa-check-square-o").addClass("fa-square-o");$(d.currentTarget).parent().parent().find("span").css({opacity:1});$(d.currentTarget).parent().parent().find(".desc").css("text-decoration","none");Dashboard.console.log(" > > Set Status Action to Active.");i.data.goals[0]-=1}}catch(a){console.log(a)}$.ajax({type:"GET",data:{status:b,id:f},url:Dashboard.properties.configuration.baseComponentURL+Dashboard.properties.configuration.updateGoalURL,async:false,contentType:"application/text",success:function(e){Dashboard.console.log(" > > Update Goal Response: "+e)},error:function(j,e,k){Dashboard.console.log(" > > Ajax Error: "+j+"; "+e+"; "+k)}});Dashboard.setStats(i);return false};Dashboard.addGoal=function(){Dashboard.console.log(":: addGoal");if($("#AddGoal").val().length>0){var e=Dashboard.getComponent("goalsAndStatistics");var a=$("#AddGoal").val();var d=this;$("#AddGoal").val("");try{this.callService("goalsAndStatistics")}catch(b){Dashboard.console.log("goalsAndStatistics.addGoal Service Error: "+b)}$("#GoalsList").html($("#GoalsList").html().replace("{value}",a))}else{$.gritter.add({title:"Add Goal",text:"We could not add the goal, it appears to be blank. Please try again.",class_name:"my-sticky-class"})}};Dashboard.openMovie=function(b){try{var e=Dashboard.getComponent("weeklyTimeline").data.activities[b];if(Dashboard.properties.configuration.loggingVerbose){Dashboard.console.log(" > > Activity: "+e,2)}$("#week-day-view").modal("hide");$("#videoName").html(e.label);$("#overlayVideo").attr("src",e.media);$("#overlayVideo").attr("title",e.label);$("#videoSmallName").html(e.label);$("#videoTime").html("loading...");$("#overlayVideo").on("timeupdate",function(a){$("#videoTime").html("Playing:&nbsp; "+getTimeLength(this.currentTime)+",&nbsp;&nbsp; <b>Duration:&nbsp; "+getTimeLength(this.duration)+"</b>")});$("#videoViewer").modal("show")}catch(d){Dashboard.console.log(d)}};Dashboard.showMessage=function(){Dashboard.console.log(" Message Center - ShowMessage()");if(Dashboard.properties.configuration.lastNewMessageDate){var a=new Date(Date.parse(Dashboard.properties.configuration.lastNewMessageDate));var b=Dashboard.daysBetween(a,new Date());Dashboard.console.log(" > Message > Days since last new message: "+b);if(parseInt(b)<=7){$("#messageCenterTitle").html("You have a new message!");$("#messageCenterContent").slideDown(800)}}};Dashboard.openArticle=function(b){try{Dashboard.console.log(" Open Article",2);var e=Dashboard.getComponent("weeklyTimeline").data.activities[b];if(Dashboard.properties.configuration.loggingVerbose){Dashboard.console.log(" > > Activity: "+e,2)}$("#week-day-view").modal("hide");$("#pdfName").html("<i class='fa fa-external-link' style='font-size:16px;font-weight:900;color:orange'></i>&nbsp; <a href='"+e.media+"' target='Article'>"+e.label+"</a>");$("#articleName").html(e.label);$("#articleViewer").modal("show")}catch(d){Dashboard.console.log(d)}};Dashboard.showTip=function(b){try{Dashboard.console.log(" Show Tip",2);var e=Dashboard.getComponent("weeklyTimeline").data.activities[b];if(Dashboard.properties.configuration.loggingVerbose){Dashboard.console.log(" > > Activity: "+e,2)}}catch(d){Dashboard.console.log(d)}};Dashboard.showNotification=function(b){var a="#notificationDescription";$(a).html(b);$(".notify").slideDown(400)};Dashboard.wizard={id:"",btnPreviousId:"",btnNextId:"",maxSteps:0,previousStep:0,currentStep:0,callback:function(){},init:function(e,a,b,d){Dashboard.wizard.id=e;Dashboard.wizard.btnNextId=a;Dashboard.wizard.btnPreviousId=b;Dashboard.wizard.callback=(d)?d:function(){};$("#"+Dashboard.wizard.btnPreviousId).click(function(){Dashboard.wizard.previous()});$("#"+Dashboard.wizard.btnNextId).click(function(){Dashboard.wizard.next()});Dashboard.wizard.maxSteps=$("#"+Dashboard.wizard.id).children("div.step").length;console.log("How many steps in this survey? "+Dashboard.wizard.maxSteps);$("#"+Dashboard.wizard.id).before("<div id='surveySteps' class='surveyWizard'></div>");$("#"+Dashboard.wizard.id).parent().css("overflow","hidden");$("#"+Dashboard.wizard.id).parent().css("min-height","200px");$("#"+Dashboard.wizard.id).children("div.step").each(function(f,g){$(this).attr("complete","false");$(this).attr("id","step-"+f);$(this).attr("valid","false");$(this).css("min-height","200px");$(this).css("position","relative");$(this).addClass("dashboard-wizard-step");$(this).hide()});$("#step-"+Dashboard.wizard.currentStep).show();Dashboard.wizard.setButtonStates()},next:function(){console.log("Next >>");Dashboard.wizard.previousStep=Dashboard.wizard.currentStep;Dashboard.wizard.currentStep++;Dashboard.wizard.goToStep();Dashboard.wizard.setButtonStates()},previous:function(){console.log("<< Previous");Dashboard.wizard.previousStep=Dashboard.wizard.currentStep;Dashboard.wizard.currentStep--;Dashboard.wizard.goToStep();Dashboard.wizard.setButtonStates()},setButtonStates:function(){$previous=$("#"+Dashboard.wizard.btnPreviousId);$next=$("#"+Dashboard.wizard.btnNextId);if(Dashboard.wizard.currentStep>0){$("#"+Dashboard.wizard.btnPreviousId).removeAttr("disabled")}else{$("#"+Dashboard.wizard.btnPreviousId).attr("disabled","disabled")}if(Dashboard.wizard.currentStep<(Dashboard.wizard.maxSteps-1)){if($("#step-"+Dashboard.wizard.currentStep).attr("valid")=="true"){$("#"+Dashboard.wizard.btnNextId).removeAttr("disabled")}else{$("#"+Dashboard.wizard.btnNextId).attr("disabled","disabled")}}else{if(Dashboard.wizard.currentStep==(Dashboard.wizard.maxSteps-1)){console.log("End reached.");$("#"+Dashboard.wizard.btnNextId).html($("#"+Dashboard.wizard.btnNextId).html().replace("Next","Finish"))}else{if(Dashboard.wizard.currentStep>(Dashboard.wizard.maxSteps-1)){$(".dashboard-wizard-step").fadeOut();$("#"+Dashboard.wizard.id).fadeOut();$("#"+Dashboard.wizard.btnNextId).html($("#"+Dashboard.wizard.btnNextId).html().replace("Finish","Next"));Dashboard.wizard.callback()}}}},goToStep:function(){console.log("  -Previous Step: "+Dashboard.wizard.previousStep);console.log("  -Current Step: "+Dashboard.wizard.currentStep);if(Dashboard.wizard.previousStep<Dashboard.wizard.currentStep){console.log("  Slide Left to the next << [ NEXT ]");$("#step-"+Dashboard.wizard.previousStep).animate({left:"-100%"},400,"",function(){$("#step-"+Dashboard.wizard.previousStep).hide();$("#step-"+Dashboard.wizard.currentStep).css("left","100%");$("#step-"+Dashboard.wizard.currentStep).show();$("#step-"+Dashboard.wizard.currentStep).animate({left:"0%"},300)})}else{console.log("  Slide Right to the previus >> [ PREVIOUS ]");$("#step-"+Dashboard.wizard.previousStep).animate({left:"100%"},400,"",function(){$("#step-"+Dashboard.wizard.previousStep).hide();$("#step-"+Dashboard.wizard.currentStep).css("left","-100%");$("#step-"+Dashboard.wizard.currentStep).show();$("#step-"+Dashboard.wizard.currentStep).animate({left:"0%"},300)})}},setAsValid:function(a){$("#step-"+Dashboard.wizard.currentStep).attr("valid",a);console.log(" > Step["+Dashboard.wizard.currentStep+"] Valid: "+$("#step-"+Dashboard.wizard.currentStep).attr("valid"));Dashboard.wizard.setButtonStates()}};String.prototype.toHHMMSS=function(){var f=parseInt(this,10);var a=Math.floor(f/3600);var b=Math.floor((f-(a*3600))/60);var e=f-(a*3600)-(b*60);if(a<10){a="0"+a}if(b<10){b="0"+b}if(e<10){e="0"+e}var d=a+":"+b+":"+e;return d};function getTimeLength(a){return a.toString().toHHMMSS()}Dashboard.formatDate=function(D,x,a){var r=["\x00","January","February","March","April","May","June","July","August","September","October","November","December"];var e=["\x01","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var b=["\x02","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var i=["\x03","Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function o(f,d){var h=f+"";d=d||2;while(h.length<d){h="0"+h}return h}var l=a?D.getUTCFullYear():D.getFullYear();x=x.replace(/(^|[^\\])yyyy+/g,"$1"+l);x=x.replace(/(^|[^\\])yy/g,"$1"+l.toString().substr(2,2));x=x.replace(/(^|[^\\])y/g,"$1"+l);var j=(a?D.getUTCMonth():D.getMonth())+1;x=x.replace(/(^|[^\\])MMMM+/g,"$1"+r[0]);x=x.replace(/(^|[^\\])MMM/g,"$1"+e[0]);x=x.replace(/(^|[^\\])MM/g,"$1"+o(j));x=x.replace(/(^|[^\\])M/g,"$1"+j);var B=a?D.getUTCDate():D.getDate();x=x.replace(/(^|[^\\])dddd+/g,"$1"+b[0]);x=x.replace(/(^|[^\\])ddd/g,"$1"+i[0]);x=x.replace(/(^|[^\\])dd/g,"$1"+o(B));x=x.replace(/(^|[^\\])d/g,"$1"+B);var n=a?D.getUTCHours():D.getHours();x=x.replace(/(^|[^\\])HH+/g,"$1"+o(n));x=x.replace(/(^|[^\\])H/g,"$1"+n);var z=n>12?n-12:n==0?12:n;x=x.replace(/(^|[^\\])hh+/g,"$1"+o(z));x=x.replace(/(^|[^\\])h/g,"$1"+z);var u=a?D.getUTCMinutes():D.getMinutes();x=x.replace(/(^|[^\\])mm+/g,"$1"+o(u));x=x.replace(/(^|[^\\])m/g,"$1"+u);var q=a?D.getUTCSeconds():D.getSeconds();x=x.replace(/(^|[^\\])ss+/g,"$1"+o(q));x=x.replace(/(^|[^\\])s/g,"$1"+q);var A=a?D.getUTCMilliseconds():D.getMilliseconds();x=x.replace(/(^|[^\\])fff+/g,"$1"+o(A,3));A=Math.round(A/10);x=x.replace(/(^|[^\\])ff/g,"$1"+o(A));A=Math.round(A/10);x=x.replace(/(^|[^\\])f/g,"$1"+A);var g=n<12?"AM":"PM";x=x.replace(/(^|[^\\])TT+/g,"$1"+g);x=x.replace(/(^|[^\\])T/g,"$1"+g.charAt(0));var p=g.toLowerCase();x=x.replace(/(^|[^\\])tt+/g,"$1"+p);x=x.replace(/(^|[^\\])t/g,"$1"+p.charAt(0));var C=-D.getTimezoneOffset();var k=a||!C?"Z":C>0?"+":"-";if(!a){C=Math.abs(C);var E=Math.floor(C/60);var v=C%60;k+=o(E)+":"+o(v)}x=x.replace(/(^|[^\\])K/g,"$1"+k);var w=(a?D.getUTCDay():D.getDay())+1;x=x.replace(new RegExp(b[0],"g"),b[w]);x=x.replace(new RegExp(i[0],"g"),i[w]);x=x.replace(new RegExp(r[0],"g"),r[j]);x=x.replace(new RegExp(e[0],"g"),e[j]);x=x.replace(/\\(.)/g,"$1");return x};$.fn.scrollTo=function(d,a,e){if(typeof a=="function"&&arguments.length==2){e=a;a=d}var b=$.extend({scrollTarget:d,offsetTop:50,duration:500,easing:"swing"},a);return this.each(function(){var f=$(this);var g=(typeof b.scrollTarget=="number")?b.scrollTarget:$(b.scrollTarget);var h=(typeof g=="number")?g:g.offset().top+f.scrollTop()-parseInt(b.offsetTop);f.animate({scrollTop:h},parseInt(b.duration),b.easing,function(){if(typeof e=="function"){e.call(this)}})})};